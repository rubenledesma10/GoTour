{% include "head.html" %}

<body id="protectedBody" style="display: none;">

    {% include "partials/navbar.html" %}

<div class="container mt-4">
    <h2 class="mb-4 text-center">Centros de Informaci√≥n Tur√≠stica (CIT)</h2>

    <!-- üîπ Bot√≥n para agregar CIT (solo admin) -->
    <div class="mb-3 admin-only">
        <a href="{{ url_for('cit_bp.add_cit_page') }}" class="btn btn-primary">Agregar CIT</a>
    </div>

    <!-- üîπ Tabla de CITs -->
    <table class="table table-striped table-hover table-bordered shadow-sm align-middle">
        <thead class="table-dark text-center">
            <tr>
                <th>N¬∞ CIT</th>
                <th>Distrito</th>
                <th>Direcci√≥n</th>
                <th>Activo</th>
                <th>QR Mapa</th>
                <th class="admin-only">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for cit in cits %}
            <tr data-id="{{ cit.id_cit }}">
                <td>{{ cit.number_cit }}</td>
                <td>{{ cit.district }}</td>
                <td>{{ cit.address }}</td>
                <td class="text-center">
                    {% if cit.is_activate %}
                        <span class="badge bg-success">S√≠</span>
                    {% else %}
                        <span class="badge bg-secondary">No</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if cit.is_activate_qr_map %}
                        <span class="badge bg-success">S√≠</span>
                    {% else %}
                        <span class="badge bg-secondary">No</span>
                    {% endif %}
                </td>

                <!-- üîπ Acciones solo visibles para admin -->
                <td class="text-center admin-only">
                    <a href="/cit/edit/{{ cit.id_cit }}" 
                    class="btn btn-sm btn-warning text-white btnEdit" 
                    data-id="{{ cit.id_cit }}">
                        Editar
                    </a>

                    {% if cit.is_activate %}
                        <button class="btn btn-sm btn-danger btnToggle" 
                                data-id="{{ cit.id_cit }}" 
                                data-action="deactivate">
                            Desactivar
                        </button>
                    {% else %}
                        <button class="btn btn-sm btn-success btnToggle" 
                                data-id="{{ cit.id_cit }}" 
                                data-action="reactivate">
                            Reactivar
                        </button>
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center text-muted">No hay CITs registrados.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<!-- ‚úÖ Toast Container -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
    <div id="liveToast" class="toast text-white bg-dark border-0" role="alert">
        <div class="d-flex">
            <div class="toast-body" id="toastMessage">Mensaje...</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

<script src="/static/Cits/cits.js"></script>
{% include "scripts.html" %}
</body>
</html>
